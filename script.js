window.onload = () => {
    canvas = document.getElementById("canvas");
    canvas.width = canvas.clientWidth;
    canvas.height = canvas.clientHeight;
    ctx = canvas.getContext("2d");
    framesPerSecond = 60;
    storage = {};
    map = new GameMap('./map.png');
    colliders = [3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703, 3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703, 3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3703,
        3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703, 3703]
    tileWidth = 32;
    tileHeight = 32;
    colliderBoxes = [];
    for (var i = 0; i < colliders.length; i++) {
        if (colliders[i] != 0) {
            let x = (i % 30) * 32;
            let y = (Math.floor(i / 30)) * 32;
            let w = tileWidth * scale;
            let h = tileHeight * scale;
            colliderBoxes.push({
                x: x,
                y: y,
                w: w,
                h: h
            });
        } else {
            continue;
        }
    };
    player = new Sprite('./tiles', 32, 32, 32, 32, {
        x: 32,
        y: 32,
        w: 16,
        h: 16
    }, true, 10);
    init();
    gameInterval = setInterval(() => {
        update();
    }, 1000 / framesPerSecond);
};